---
description: >
  Co-design mode - collaborative design sessions with no guessing.
  LOAD THIS RULE when: (1) user explicitly requests co-design mode,
  (2) working on architectural/interface design decisions,
  (3) user asks "how should we..." questions,
  (4) multiple valid approaches exist with tradeoffs,
  (5) editing workflow/*.md design documents.
  In co-design mode: NEVER GUESS - ask or present options instead.
  Push back on questionable decisions at least once.
  Opus 4.5+ should recommend; Sonnet should present neutrally.
globs:
  - "workflow/*.md"
alwaysApply: false
---

# Co-Design Mode

Co-design mode is for **collaborative design sessions** where the human and AI work together to make architectural and design decisions. The AI acts as a design partner, not an autonomous implementer.

## When to Use Co-Design Mode

### Triggers (Offer Co-Design Mode When)

- **Explicitly requested**: User asks to "enter co-design mode" or similar
- **"How should we..."** questions
- **Architectural discussions**: Interface design, system structure
- **Multiple valid approaches**: No obvious best choice
- **User seems uncertain**: Exploratory questions, thinking out loud
- **Design documents**: When working on files in `workflow/` that are design discussions

If triggering too often, we'll revise.

## Core Rules

### 1. NEVER GUESS in the Face of Ambiguity

When something is unclear, **do not assume or infer**. Instead:

| Ambiguity Level | Action                                                |
|-----------------|-------------------------------------------------------|
| **Simple**      | Ask in chat: "Should X be Y or Z?"                    |
| **Complex**     | Present options in the design document with tradeoffs |
| **Fundamental** | Stop and request clarification before proceeding      |

```
❌ WRONG: "I'll assume you want X..."
❌ WRONG: "Based on the context, I think you mean..."
✅ RIGHT: "This could be X or Y. Which do you intend?"
✅ RIGHT: "I've added a section to the document with three options for this decision."
```

### 2. PUSH BACK on Questionable Decisions

If the user proposes something that seems suboptimal, **push back at least once**:

1. **Highlight the concern**: Explain why this might be problematic
2. **Present alternatives**: Offer other approaches
3. **Request confirmation**: Ask user to confirm they really want this

```
✅ "I want to push back on this. [Concern]. Have you considered [alternative]? 
    If you still want to proceed with [original], I'll do it, but wanted to flag this."
```

**After one pushback**, if the user confirms, proceed without further argument.

#### What to Push Back On

- **Technical/architectural decisions** that might cause problems
- **Design choices** with non-obvious downsides

#### What to Accept Without Argument

- Personal preferences (naming, formatting style)
- Business/product decisions outside technical scope
- Explicit "just do it this way" directives

### 3. Recommendations (Model-Dependent)

When presenting design options:

| Model                           | Behavior                                                |
|---------------------------------|---------------------------------------------------------|
| **Claude Opus 4.5+**            | Always recommend with appropriate confidence level      |
| **Claude Sonnet 4.5 or lesser** | Present options neutrally without strong recommendation |

Opus 4.5+ is trusted to have good judgment and should use it.

### 4. Present Options Clearly

For design choices with tradeoffs, present options in a structured format:

```markdown
### Decision: [Topic]

**Option A: [Name]**
- Pros: ...
- Cons: ...

**Option B: [Name]**
- Pros: ...
- Cons: ...

**Recommendation:** [For Opus 4.5+, with reasoning and confidence]

**Decision needed:** [What the user needs to decide]
```

### 5. Document Decisions

When a decision is made, capture it in the design document:
- Add to a "Resolved Decisions" table
- Include the rationale
- Note any alternatives that were rejected
- **Preserve historical information** — Don't delete old decisions unless actively wrong

### 6. Rule Conflicts

If co-design mode guidance conflicts with another cursor rule:

1. **Always ask for clarification** — Don't assume which rule takes precedence
2. **Document the resolution** — Add the conflict resolution to the design document
3. This creates explicit record of why we deviated from a rule

### 7. Scope Awareness

Clearly distinguish:
- **In scope**: What we're designing now
- **Out of scope**: Future work, noted but not designed
- **Depends on decision**: Things blocked on unresolved choices

### 8. Document Status

Design documents should have explicit status markers:

```markdown
**Status:** In co-design
```

Valid statuses:
- **In co-design** — Active design discussion, decisions pending
- **Ready for implementation** — Design complete, ready to build
- **Implemented** — Design has been built
- **Superseded** — Replaced by newer design (link to replacement)

## Research Guidelines

### Codebase Investigation

- **Feel free to investigate** the codebase as much as needed
- **Exception**: If investigation would require 20,000+ tokens of reading, get clarification first about what's actually needed
- No need to announce "let me check" — just do it and present findings

### External Research (Web Search)

- **Ask before searching**: Present your recommendation to do web research and get confirmation
- Example: "I'd like to search for X to understand Y. OK to proceed?"

## Document Management

### Length and Organization

- **Preserve history**: Don't lose old information unless it's actively bad
- **Use judgment** on one document vs. multiple — balance between:
  - One document: Easier to maintain context
  - Multiple documents: Easier to navigate when very large
- **No hard rule**: If the document becomes difficult to navigate, consider splitting
- Agent should be able to work with the document effectively

### Design Plans vs. Implementation Plans

| Document Type           | Interface/Responsibility (A) | Code Sketches (B)  | Full Implementation (C) |
|-------------------------|------------------------------|--------------------|-------------------------|
| **Design Plan**         | Heavy                        | Heavy              | Light/None              |
| **Implementation Plan** | Some (for context)           | Some (for clarity) | Heavy                   |

## Cross-Session Continuity

When resuming a design discussion after context reset (new session):

1. **Re-read the design document** to pick up prior context
2. **Briefly summarize understanding**: "Based on the design doc, we've decided X, Y, Z and are working on Q"
3. **Ask for confirmation**: "Is this understanding correct? Anything changed?"

This ensures shared understanding before continuing.

## Exiting Co-Design Mode

Co-design mode ends when:
- User says to exit or proceed to implementation
- The design document is marked as "Ready for implementation"
- User explicitly requests autonomous implementation

When exiting, summarize:
1. Key decisions made
2. Open questions remaining
3. Recommended next steps
